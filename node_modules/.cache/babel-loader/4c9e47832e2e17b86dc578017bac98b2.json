{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Bar-PC\\\\Desktop\\\\sprint 4\\\\src\\\\pages\\\\StayDetails.jsx\";\nimport { Component } from \"react\";\nimport { stayService } from \"../services/stay-service\";\nimport { ReviewList } from '../cmps/stay-details/ReviewList';\nimport { BookStay } from \"../cmps/stay-details/BookStay\";\nimport { GoogleMap } from '../cmps/stay-details/GoogleMap';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport class StayDetails extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      stay: null\n    };\n\n    this.scrollUp = () => {\n      window.scroll({\n        top: 0,\n        behavior: 'smooth'\n      });\n    };\n\n    this.loadStay = async () => {\n      const {\n        stayId\n      } = this.props.match.params;\n      const stay = await stayService.getById(stayId);\n      this.setState({\n        stay\n      });\n    };\n\n    this.onAddToWishList = () => {\n      console.log('whishList');\n      const user = this.props.loggedInUser;\n\n      if (user.whishlist) {\n        user.whishlist.push(this.state.stay._id);\n      }\n\n      user.whishlist = [this.state.stay._id];\n      this.props.updateUser(user);\n    };\n\n    this.getTotalRate = () => {\n      const rates = this.state.stay.reviews.map(review => review.avgRate);\n      const sum = rates.reduce((acc, rate) => {\n        acc += rate;\n        return acc;\n      }, 0);\n      return (sum / rates.length).toFixed(1);\n    };\n\n    this.getStayReviewStatistics = () => {\n      const {\n        reviews\n      } = this.state.stay;\n      const num = reviews.length;\n      if (!reviews) return;\n      const reviewCtgMap = {\n        \"Cleanliness\": 0,\n        \"Accuracy\": 0,\n        \"Communication\": 0,\n        \"Location\": 0,\n        \"Check-in\": 0,\n        \"Accessibility\": 0\n      };\n      reviews.forEach(review => {\n        for (const key in review.category) {\n          reviewCtgMap[key] += review.category[key];\n        }\n      });\n\n      for (const ctg in reviewCtgMap) {\n        reviewCtgMap[ctg] = +(reviewCtgMap[ctg] / num).toFixed(1);\n      }\n\n      const elReviews = [];\n\n      for (const ctg in reviewCtgMap) {\n        elReviews.push( /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"ctg-statistics\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            children: ctg\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 76,\n            columnNumber: 74\n          }, this), \" \", /*#__PURE__*/_jsxDEV(\"span\", {\n            children: reviewCtgMap[ctg]\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 76,\n            columnNumber: 89\n          }, this)]\n        }, Math.random(), true, {\n          fileName: _jsxFileName,\n          lineNumber: 76,\n          columnNumber: 22\n        }, this));\n      }\n\n      return elReviews;\n    };\n  }\n\n  componentDidMount() {\n    this.loadStay();\n    this.scrollUp();\n  }\n\n  getAmenityIcon(amenity) {\n    switch (amenity) {\n      case 'TV':\n        return /*#__PURE__*/_jsxDEV(\"i\", {\n          className: \"fas fa-tv\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 85,\n          columnNumber: 16\n        }, this);\n\n      case 'Wifi':\n        return /*#__PURE__*/_jsxDEV(\"i\", {\n          className: \"fas fa-wifi\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 87,\n          columnNumber: 16\n        }, this);\n\n      case 'Air-conditioning':\n        return /*#__PURE__*/_jsxDEV(\"i\", {\n          className: \"fas fa-fan\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 89,\n          columnNumber: 16\n        }, this);\n\n      case 'Smoking allowed':\n        return /*#__PURE__*/_jsxDEV(\"i\", {\n          className: \"fas fa-smoking\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 91,\n          columnNumber: 16\n        }, this);\n\n      case 'Pets allowed':\n        return /*#__PURE__*/_jsxDEV(\"i\", {\n          className: \"fas fa-paw\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 93,\n          columnNumber: 16\n        }, this);\n\n      case 'Cooking basics':\n        return /*#__PURE__*/_jsxDEV(\"i\", {\n          className: \"fas fa-blender\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 95,\n          columnNumber: 16\n        }, this);\n\n      default:\n        return /*#__PURE__*/_jsxDEV(\"i\", {\n          className: \"fab fa-airbnb\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 97,\n          columnNumber: 16\n        }, this);\n    }\n  }\n\n  render() {\n    const {\n      stay\n    } = this.state;\n    const {\n      loggedInUser,\n      toggleMsgModal,\n      onSearch\n    } = this.props;\n    if (!stay) return /*#__PURE__*/_jsxDEV(\"h1\", {\n      children: \"loading...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 23\n    }, this);\n    const {\n      loc,\n      capacity,\n      desc,\n      amenities,\n      stayType,\n      propertyType,\n      reviews,\n      name,\n      host\n    } = stay;\n    return /*#__PURE__*/_jsxDEV(\"main\", {\n      className: \"stay-details-container page\",\n      children: [/*#__PURE__*/_jsxDEV(\"section\", {\n        className: \"stay-details-header\",\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          children: name\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 111,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"stay-short-info\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"stay-rate-display\",\n              children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                className: \"fas fa-star\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 114,\n                columnNumber: 51\n              }, this), this.getTotalRate(), /*#__PURE__*/_jsxDEV(\"p\", {\n                children: [\"( \", reviews.length, \" reviews )\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 114,\n                columnNumber: 103\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 114,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"\\u2022\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 115,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: loc.address\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 116,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 113,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              children: /*#__PURE__*/_jsxDEV(\"p\", {\n                children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                  className: \"fas fa-external-link-alt\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 119,\n                  columnNumber: 26\n                }, this), \"share\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 119,\n                columnNumber: 23\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 119,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: this.onAddToWishList,\n              className: \"stay-save-btn\",\n              children: /*#__PURE__*/_jsxDEV(\"p\", {\n                children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                  className: \"far fa-heart\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 120,\n                  columnNumber: 83\n                }, this), \"save\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 120,\n                columnNumber: 80\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 120,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 118,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 112,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"stay-gallery\",\n        children: stay.imgUrls.map(imgUrl => /*#__PURE__*/_jsxDEV(\"img\", {\n          src: imgUrl,\n          alt: \"stay-gallery-preview-img\"\n        }, imgUrl, false, {\n          fileName: _jsxFileName,\n          lineNumber: 125,\n          columnNumber: 39\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 124,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"section\", {\n        className: \"stay-info-container\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"stay-long-info\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"stay-long-info-header\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n                children: `${propertyType} hosted by ${host.fullname}`\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 131,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                children: [capacity, \" guests \\u2022 \", stayType, \" \\u2022 \", propertyType]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 132,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 130,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n              src: host.imgUrl,\n              alt: \"avatar\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 134,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 129,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"stay-feature-container\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                className: \"fas fa-home\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 138,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n                  children: stayType\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 140,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"h4\", {\n                  children: stayType === 'entire place' ? \"You'll have the place to yourself.\" : \"You'll have a private room to yourself.\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 141,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 139,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 137,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                className: \"fas fa-book-open\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 145,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n                  children: \"House rules\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 147,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"h4\", {\n                  children: \"This place isn\\u2019t suitable for children under 12 and the host doesn\\u2019t allow pets.\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 148,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 146,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 144,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                className: \"fas fa-medal\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 152,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n                  children: [host.fullname, \" is a Superhost\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 154,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"h4\", {\n                  children: \"Superhosts are experienced, highly rated hosts who are committed to providing great stays for guests.\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 155,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 153,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 151,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                className: \"fas fa-bookmark\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 159,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n                  children: \"Wifi\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 161,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"h4\", {\n                  children: \"Guests often search for this popular amenity\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 162,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 160,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 158,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 136,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"description\",\n            children: desc\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 166,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"amenities-list\",\n            children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n              children: \"Amenities\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 168,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n              children: amenities.map(amenity => {\n                return /*#__PURE__*/_jsxDEV(\"li\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    children: this.getAmenityIcon(amenity)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 170,\n                    columnNumber: 70\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    children: amenity\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 170,\n                    columnNumber: 113\n                  }, this)]\n                }, amenity, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 170,\n                  columnNumber: 52\n                }, this);\n              })\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 169,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 167,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 128,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(BookStay, {\n          stay: stay,\n          getTotalRate: this.getTotalRate,\n          onSearch: onSearch,\n          loggedInUser: loggedInUser,\n          toggleMsgModal: toggleMsgModal\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 174,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"section\", {\n        className: \"stay-review-container\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"stay-review-header\",\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n            children: /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"stay-rate-display\",\n              children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                className: \"fas fa-star\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 178,\n                columnNumber: 54\n              }, this), this.getTotalRate(), \" \", /*#__PURE__*/_jsxDEV(\"p\", {\n                children: [\" ( \", reviews.length, \" reviews )\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 178,\n                columnNumber: 108\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 178,\n              columnNumber: 18\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 178,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"stay-review-ststistics\",\n            children: this.getStayReviewStatistics().map(elCtgRate => elCtgRate)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 179,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 177,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(ReviewList, {\n          reviews: reviews\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 183,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 176,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"section\", {\n        className: \"stay-details-map\",\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          children: \"Location\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 186,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(GoogleMap, {\n          pos: loc\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 187,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 185,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 7\n    }, this);\n  }\n\n}","map":{"version":3,"sources":["C:/Users/Bar-PC/Desktop/sprint 4/src/pages/StayDetails.jsx"],"names":["Component","stayService","ReviewList","BookStay","GoogleMap","StayDetails","state","stay","scrollUp","window","scroll","top","behavior","loadStay","stayId","props","match","params","getById","setState","onAddToWishList","console","log","user","loggedInUser","whishlist","push","_id","updateUser","getTotalRate","rates","reviews","map","review","avgRate","sum","reduce","acc","rate","length","toFixed","getStayReviewStatistics","num","reviewCtgMap","forEach","key","category","ctg","elReviews","Math","random","componentDidMount","getAmenityIcon","amenity","render","toggleMsgModal","onSearch","loc","capacity","desc","amenities","stayType","propertyType","name","host","address","imgUrls","imgUrl","fullname","elCtgRate"],"mappings":"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","sourcesContent":["import { Component } from \"react\";\r\nimport { stayService } from \"../services/stay-service\";\r\nimport { ReviewList } from '../cmps/stay-details/ReviewList';\r\nimport { BookStay } from \"../cmps/stay-details/BookStay\";\r\nimport { GoogleMap } from '../cmps/stay-details/GoogleMap';\r\nexport class StayDetails extends Component {\r\n\r\n  state = {\r\n    stay: null\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.loadStay()\r\n    this.scrollUp()\r\n  }\r\n\r\n  scrollUp = () => {\r\n    window.scroll({\r\n      top: 0,\r\n      behavior: 'smooth'\r\n    })\r\n  }\r\n\r\n  loadStay = async () => {\r\n    const { stayId } = this.props.match.params\r\n    const stay = await stayService.getById(stayId)\r\n    this.setState({ stay })\r\n  }\r\n  onAddToWishList=()=>{\r\n    console.log('whishList');\r\n    const user=this.props.loggedInUser\r\n    if(user.whishlist)\r\n    {\r\n      user.whishlist.push(this.state.stay._id)\r\n    }\r\n    user.whishlist=[this.state.stay._id]\r\n    this.props.updateUser(user)\r\n  }\r\n  getTotalRate = () => {\r\n    const rates = this.state.stay.reviews.map(review => review.avgRate)\r\n    const sum = rates.reduce((acc, rate) => {\r\n      acc += rate\r\n      return acc\r\n    }, 0)\r\n    return (sum / rates.length).toFixed(1)\r\n  }\r\n\r\n  getStayReviewStatistics = () => {\r\n    const { reviews } = this.state.stay\r\n    const num = reviews.length\r\n\r\n    if (!reviews) return\r\n\r\n    const reviewCtgMap = {\r\n      \"Cleanliness\": 0,\r\n      \"Accuracy\": 0,\r\n      \"Communication\": 0,\r\n      \"Location\": 0,\r\n      \"Check-in\": 0,\r\n      \"Accessibility\": 0\r\n    }\r\n\r\n    reviews.forEach(review => {\r\n      for (const key in review.category) {\r\n        reviewCtgMap[key] += review.category[key]\r\n      }\r\n    })\r\n\r\n    for (const ctg in reviewCtgMap) {\r\n      reviewCtgMap[ctg] = +(reviewCtgMap[ctg] / num).toFixed(1)\r\n    }\r\n\r\n    const elReviews = []\r\n\r\n    for (const ctg in reviewCtgMap) {\r\n      elReviews.push(<div key={Math.random()} className=\"ctg-statistics\"><h3>{ctg}</h3> <span>{reviewCtgMap[ctg]}</span></div>)\r\n    }\r\n\r\n    return elReviews\r\n  }\r\n\r\n  getAmenityIcon(amenity) {\r\n    switch (amenity) {\r\n      case 'TV':\r\n        return <i className=\"fas fa-tv\"></i>\r\n      case 'Wifi':\r\n        return <i className=\"fas fa-wifi\"></i>\r\n      case 'Air-conditioning':\r\n        return <i className=\"fas fa-fan\"></i>\r\n      case 'Smoking allowed':\r\n        return <i className=\"fas fa-smoking\"></i>\r\n      case 'Pets allowed':\r\n        return <i className=\"fas fa-paw\"></i>\r\n      case 'Cooking basics':\r\n        return <i className=\"fas fa-blender\"></i>\r\n      default:\r\n        return <i className=\"fab fa-airbnb\"></i>\r\n    }\r\n  }\r\n\r\n\r\n  render() {\r\n    const { stay } = this.state\r\n    const { loggedInUser, toggleMsgModal, onSearch } = this.props\r\n    if (!stay) return <h1>loading...</h1>\r\n    const { loc, capacity, desc, amenities, stayType, propertyType, reviews, name, host } = stay\r\n\r\n    return (\r\n      <main className=\"stay-details-container page\">\r\n        <section className=\"stay-details-header\">\r\n          <h1>{name}</h1>\r\n          <div className=\"stay-short-info\">\r\n            <div>\r\n              <span className=\"stay-rate-display\"><i className=\"fas fa-star\"></i>{this.getTotalRate()}<p>( {reviews.length} reviews )</p></span>\r\n              <span>•</span>\r\n              <p>{loc.address}</p>\r\n            </div>\r\n            <div>\r\n              <button><p><i className=\"fas fa-external-link-alt\"></i>share</p></button>\r\n              <button onClick={this.onAddToWishList} className=\"stay-save-btn\"><p><i className=\"far fa-heart\"></i>save</p></button>\r\n            </div>\r\n          </div>\r\n        </section>\r\n        <div className=\"stay-gallery\">\r\n          {stay.imgUrls.map(imgUrl => <img src={imgUrl} alt=\"stay-gallery-preview-img\" key={imgUrl} />)}\r\n        </div>\r\n        <section className=\"stay-info-container\">\r\n          <div className=\"stay-long-info\">\r\n            <div className=\"stay-long-info-header\">\r\n              <div>\r\n                <h2>{`${propertyType} hosted by ${host.fullname}`}</h2>\r\n                <span>{capacity} guests • {stayType} • {propertyType}</span>\r\n              </div>\r\n              <img src={host.imgUrl} alt=\"avatar\" />\r\n            </div>\r\n            <div className=\"stay-feature-container\">\r\n              <div>\r\n                <i className=\"fas fa-home\"></i>\r\n                <div>\r\n                  <h3>{stayType}</h3>\r\n                  <h4>{stayType === 'entire place' ? \"You'll have the place to yourself.\" : \"You'll have a private room to yourself.\"}</h4>\r\n                </div>\r\n              </div>\r\n              <div>\r\n                <i className=\"fas fa-book-open\"></i>\r\n                <div>\r\n                  <h3>House rules</h3>\r\n                  <h4>This place isn’t suitable for children under 12 and the host doesn’t allow pets.</h4>\r\n                </div>\r\n              </div>\r\n              <div>\r\n                <i className=\"fas fa-medal\"></i>\r\n                <div>\r\n                  <h3>{host.fullname} is a Superhost</h3>\r\n                  <h4>Superhosts are experienced, highly rated hosts who are committed to providing great stays for guests.</h4>\r\n                </div>\r\n              </div>\r\n              <div>\r\n                <i className=\"fas fa-bookmark\"></i>\r\n                <div>\r\n                  <h3>Wifi</h3>\r\n                  <h4>Guests often search for this popular amenity</h4>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <span className=\"description\">{desc}</span>\r\n            <div className=\"amenities-list\">\r\n              <h2>Amenities</h2>\r\n              <ul>\r\n                {amenities.map(amenity => { return <li key={amenity}><span>{this.getAmenityIcon(amenity)}</span><span>{amenity}</span></li> })}\r\n              </ul>\r\n            </div>\r\n          </div>\r\n          <BookStay stay={stay} getTotalRate={this.getTotalRate} onSearch={onSearch} loggedInUser={loggedInUser} toggleMsgModal={toggleMsgModal} />\r\n        </section>\r\n        <section className=\"stay-review-container\">\r\n          <div className=\"stay-review-header\">\r\n            <h2>{<span className=\"stay-rate-display\"><i className=\"fas fa-star\"></i>{this.getTotalRate() } <p> ( {reviews.length} reviews )</p></span>}</h2>\r\n            <div className=\"stay-review-ststistics\">\r\n              {this.getStayReviewStatistics().map(elCtgRate => elCtgRate)}\r\n            </div>\r\n          </div>\r\n          <ReviewList reviews={reviews} />\r\n        </section>\r\n        <section className=\"stay-details-map\" >\r\n        <h2>Location</h2>\r\n          <GoogleMap pos={loc} />\r\n        </section>\r\n      </main>\r\n    )\r\n  }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}